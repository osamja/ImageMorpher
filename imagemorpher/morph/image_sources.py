import skimage.io as skio
import matplotlib.pyplot as plt
import numpy as np
import os
import sys

def getImages():
  dir_path = os.path.dirname(os.path.realpath(__file__)) + '/images'
  adele_low_res = skio.imread(dir_path + '/adele_2.jpg')
  tiger_low_res = skio.imread(dir_path + '/tiger_2.jpg')
  adele_high_res = skio.imread(dir_path + '/adele_high.jpg')
  tiger_high_res = skio.imread(dir_path + '/tiger_high.jpg')
  clooney_fit = skio.imread(dir_path + '/clooney_fit.jpg')
  obama_fit = skio.imread(dir_path + '/obama_fit.jpg')
  adele_small = skio.imread(dir_path + '/adele_small.jpg')
  tiger_small = skio.imread(dir_path + '/tiger_small.jpg')


  images = {
    'adele_low_res': adele_low_res,
    'adele_high_res': adele_high_res,
    'tiger_low_res': tiger_low_res,
    'tiger_high_res': tiger_high_res,
    'clooney_fit': clooney_fit,
    'obama_fit': obama_fit,
    'adele_small': adele_small,
    'tiger_small': tiger_small
  }

  return images

def getCorrespondingPts(img_name, images, num_corresponding_pts=30):
  adele_low_res = [(4.22402597402597, 5.176406926406926), (14.234848484848484, 4.7976190476190474), (9.012987012987011, 5.041125541125538), (4.765151515151512, 2.903679653679653), (13.63961038961039, 2.903679653679653), (8.796536796536795, 2.8766233766233746), (8.958874458874458, 15.403679653679653), (3.709956709956707, 15.674242424242424), (16.724025974025974, 15.430735930735931), (9.229437229437227, 19.46212121212121)]
  tiger_low_res = [(4.494588744588741, 4.716450216450216), (13.883116883116884, 4.472943722943722), (9.527056277056275, 4.905844155844154), (3.926406926406923, 3.498917748917748), (14.721861471861473, 3.1471861471861438), (9.28354978354978, 3.4718614718614695), (9.527056277056275, 16.485930735930737), (2.3300865800865758, 15.106060606060606), (16.23701298701299, 14.727272727272727), (9.554112554112553, 19.272727272727273)]
  adele_high_res = [(52.665584415584334, 81.20995670995671), (116.24783549783547, 57.53571428571422), (171.0367965367965, 72.41666666666663), (241.38311688311688, 87.29761904761904), (290.7608225108225, 80.53354978354974), (361.10714285714283, 56.85930735930731), (430.77705627705626, 67.00541125541122), (83.10389610389603, 135.32251082251082), (136.54004329004323, 139.38095238095235), (181.8593073593073, 142.08658008658006), (242.0595238095238, 135.99891774891773), (300.9069264069264, 141.41017316017314), (348.9318181818182, 136.67532467532465), (394.2510822510822, 137.35173160173156), (51.98917748917742, 292.24891774891773), (108.80735930735926, 282.7792207792208), (162.24350649350646, 279.3971861471861), (206.20995670995666, 285.4848484848485), (234.6190476190476, 261.13419913419915), (269.79220779220776, 285.4848484848485), (317.81709956709955, 278.7207792207792), (376.66450216450215, 273.3095238095238), (459.86255411255416, 278.7207792207792), (165.62554112554108, 372.741341991342), (235.97186147186142, 376.12337662337666), (313.758658008658, 375.4469696969697), (234.6190476190476, 349.0670995670996), (234.6190476190476, 424.82467532467535), (108.80735930735926, 430.23593073593076), (380.0465367965368, 452.5573593073593)]
  tiger_high_res = [(80.39826839826833, 89.32683982683983), (116.24783549783547, 69.71103896103892), (146.68614718614714, 76.47510822510822), (240.70670995670991, 90.67965367965365), (336.75649350649354, 83.23917748917745), (370.57683982683983, 69.71103896103892), (401.01515151515156, 76.47510822510822), (105.42532467532459, 107.5898268398268), (133.83441558441552, 112.3246753246753), (154.80303030303025, 120.44155844155841), (238.67748917748912, 128.55844155844153), (333.37445887445887, 129.23484848484844), (359.0779220779221, 120.44155844155841), (386.13419913419915, 113.67748917748918), (54.69480519480513, 326.0692640692641), (112.18939393939388, 322.68722943722946), (147.36255411255405, 322.68722943722946), (213.65043290043286, 325.3928571428571), (248.82359307359303, 315.24675324675326), (293.4664502164502, 324.0400432900433), (359.754329004329, 305.10064935064935), (402.3679653679654, 303.07142857142856), (433.482683982684, 302.39502164502164), (177.1244588744588, 412.64935064935065), (241.38311688311688, 405.20887445887445), (300.2305194805195, 410.62012987012986), (244.0887445887446, 384.91666666666663), (242.7359307359307, 416.03138528138527), (89.86796536796533, 407.9145021645022), (410.48484848484844, 407.23809523809524)]
  clooney_fit = [(85.328125, 247.10937500000006), (58.854166666666686, 331.20312500000006), (100.90104166666669, 448.0), (150.734375, 513.40625), (231.71354166666663, 541.4375), (315.80729166666663, 519.63541666666674), (374.984375, 451.11458333333337), (423.26041666666663, 334.31770833333337), (393.671875, 240.88020833333337), (239.5, 158.34375), (118.03125, 220.63541666666669), (160.078125, 264.23958333333337), (199.01041666666669, 226.86458333333337), (269.08854166666663, 228.42187500000006), (318.921875, 262.68229166666669), (353.18229166666663, 217.52083333333337), (236.38541666666663, 289.15625000000006), (208.35416666666669, 368.57812500000006), (234.828125, 345.21875000000006), (261.30208333333337, 368.57812500000006), (231.71354166666663, 427.75520833333337), (170.97916666666669, 440.21354166666669), (191.22395833333331, 448.0), (228.59895833333331, 452.671875), (264.41666666666663, 451.11458333333337), (300.234375, 440.21354166666669), (1.234375, 1.0572916666667425), (2.7916666666666856, 597.5), (476.20833333333326, 5.7291666666667425), (476.20833333333326, 597.5)]
  obama_fit = [(71.3125, 228.42187500000006), (38.609375, 320.30208333333337), (102.45833333333331, 433.984375), (149.17708333333331, 502.50520833333337), (234.828125, 536.765625), (315.80729166666663, 518.078125), (371.86979166666663, 452.671875), (443.50520833333326, 317.18750000000006), (409.24479166666663, 215.96354166666669), (244.171875, 114.73958333333337), (107.13020833333331, 205.06250000000006), (169.421875, 233.09375000000006), (209.91145833333331, 186.37500000000006), (284.66145833333337, 184.81770833333337), (329.82291666666663, 234.65104166666669), (360.96875, 187.93229166666669), (244.171875, 265.79687500000006), (208.35416666666669, 343.66145833333337), (242.61458333333337, 324.97395833333337), (276.875, 340.54687500000006), (242.61458333333337, 388.82291666666669), (170.97916666666669, 421.52604166666669), (200.56770833333331, 440.21354166666669), (239.5, 446.44270833333337), (284.66145833333337, 435.54166666666669), (323.59375, 418.41145833333337), (5.90625, 5.7291666666667425), (4.3489583333333712, 589.71354166666663), (473.09375, 5.7291666666667425), (471.53645833333326, 592.828125)]
  adele_small = [(10.403679653679639, 15.300865800865793), (22.84956709956709, 11.648268398268385), (35.29545454545453, 15.706709956709943), (48.01190476190476, 18.0064935064935), (57.07575757575758, 15.841991341991331), (70.06277056277057, 11.512987012986997), (86.2965367965368, 13.406926406926388), (14.597402597402585, 25.988095238095227), (27.04329004329003, 27.611471861471856), (37.59523809523809, 27.611471861471856), (48.28246753246752, 27.882034632034618), (58.42857142857143, 28.82900432900432), (69.38636363636364, 27.34090909090908), (79.8030303030303, 27.20562770562769), (10.268398268398258, 55.479437229437224), (23.12012987012986, 54.66774891774891), (34.619047619047606, 55.344155844155836), (41.51839826839826, 56.83225108225108), (47.33549783549783, 50.203463203463194), (54.099567099567096, 56.69696969696969), (59.51082251082251, 55.479437229437224), (74.39177489177489, 54.66774891774891), (94.00757575757576, 55.88528138528138), (32.18398268398268, 75.23051948051948), (46.65909090909091, 75.36580086580086), (63.569264069264065, 74.82467532467533), (46.38852813852813, 69.27813852813853), (47.200216450216445, 84.2943722943723), (19.60281385281384, 84.70021645021646), (79.53246753246754, 85.51190476190476)]
  tiger_small = [(13.78571428571427, 17.465367965367946), (24.202380952380942, 14.489177489177479), (33.53679653679653, 15.97727272727272), (48.28246753246752, 18.141774891774872), (59.91666666666666, 18.27705627705626), (72.76839826839827, 12.86580086580085), (84.26731601731602, 17.600649350649334), (19.19696969696969, 22.470779220779207), (25.961038961038952, 22.200216450216445), (31.64285714285714, 23.553030303030297), (47.606060606060595, 25.85281385281384), (64.78679653679653, 27.74675324675323), (71.95670995670996, 23.41774891774891), (78.58549783549783, 22.200216450216445), (6.61580086580085, 61.56709956709956), (23.661255411255404, 60.75541125541125), (32.58982683982683, 60.75541125541125), (41.92424242424242, 64.54329004329004), (49.36471861471861, 62.78463203463203), (58.563852813852805, 65.08441558441558), (68.57467532467533, 61.97294372294372), (80.20887445887446, 60.21428571428571), (91.57251082251084, 60.21428571428571), (34.213203463203456, 82.26515151515152), (47.87662337662337, 80.91233766233766), (57.752164502164504, 81.4534632034632), (48.95887445887445, 76.31277056277057), (48.41774891774891, 85.24134199134198), (14.056277056277047, 87.27056277056278), (79.12662337662337, 87.9469696969697)]

  corresponding_pts = {
    'adele_low_res': adele_low_res,
    'tiger_low_res': tiger_low_res,
    'adele_high_res': adele_high_res,
    'tiger_high_res': tiger_high_res,
    'clooney_fit': clooney_fit,
    'obama_fit': obama_fit,
    'adele_small': adele_small,
    'tiger_small': tiger_small
  }

  img = images[img_name]

  if img_name in corresponding_pts:
    corresponding_pts = corresponding_pts[img_name]
  else:
    corresponding_pts = select_corresponding_pts(img, num_corresponding_pts)

  corresponding_pts = addCornerPoints(img, corresponding_pts)

  return np.array(corresponding_pts)

def addCornerPoints(im1, pts):
	minW, minH = 0, 0
	maxW, maxH = im1.shape[1], im1.shape[0]
	halfW, halfH = int(im1.shape[1]/2), int(im1.shape[0]/2)
	pts.append((minW, minH))        
	pts.append((minW, maxH))
	pts.append((maxW, minH))
	pts.append((maxW, maxH))
	return pts

def select_corresponding_pts(img1, num_corresponding_pts=30):
  pts = []
  plt.imshow(img1)
  pts = plt.ginput(num_corresponding_pts, timeout=0, show_clicks=True)
  print('im1 points: \n', pts)
  return pts